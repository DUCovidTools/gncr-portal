
ibmcloud cr login

docker build . -t alisonrclarke/gncr-portal:latest
docker push alisonrclarke/gncr-portal:latest

# Copy sample

# check that we are connected
kubectl cluster-info

# Bind to appid
ibmcloud ks cluster-service-bind --cluster <cluster_name_or_ID> --namespace <namespace> --service <App_ID_instance_name>

# Update domains and secrets in ingress.yaml
cp ingress.yaml ingress.yaml.example
# Edit ingress.yaml to fill in bindSecret, host and secret

kubectl apply -f deploy-web.yaml
kubectl apply -f service-myshiny.yaml

kubectl apply -f ingress.yaml

# view the result
kubectl get deployments
kubectl get pods
kubectl get services

------------------
To update to the latest version of the dashboard, go to https://hub.docker.com/repository/docker/alisonrclarke/dashboard-test/tags?page=1
Click on the hash under 'digest' and copy the full digest, e.g. sha256:bd0590f1b17106217e131bbf8d7b58e1c12a5f5bd88d3d6470c29e8e81dde3ff
Edit deploy-web.yaml and change the digest on line 17 to match the new one.
Alternatively we could build images by creating tags in github; when built we should see a new tag in dockerhub which can be used on line 17.
Once deploy-web.yaml has been edited, run the following to deploy the changes:

kubectl apply -f deploy-web.yaml
